#!/usr/bin/env bash
# Configures your shell on a clean SO install

set -e
source $HOME/.dotfiles/.dot/env

pprint section "PREPARING SHELL"


# Install development tools in Linux
if [[ "$(uname -s)" == "Linux" ]] && [[ ! $(dpkg -s build-essential 2> /dev/null) ]]; then
  pprint step-user "Installing development tools"
  pprint newline
  pprint newline
  sudo apt-get install -q -y build-essential
fi

# Install ZSH in Linux
if [[ "$(uname -s)" == "Linux" ]] && [[ ! $(which zsh) ]]; then
  pprint step-user "Installing ZSH"
  pprint newline
  pprint newline
  sudo apt-get install -q -y zsh
fi

# Install Ruby in Linux
if [[ "$(uname -s)" == "Linux" ]] && [[ ! $(which ruby) ]]; then
  pprint step-user "Installing Ruby"
  pprint newline
  pprint newline
  sudo apt-get install -q -y ruby
fi

# Make ZSH the default login shell
if [[ $(basename $SHELL) != 'zsh' ]]; then
  pprint step-user "Setting ZSH as your shell"
  pprint newline
  pprint newline
  chsh -s $(which zsh)
fi

# Activate root user in Mac
if [[ "$(uname -s)" == "Darwin" ]]; then
  pprint step-user "Activating root user now (you will need \`sudo\` later)"
  pprint newline
  sudo echo > /dev/null
fi

pprint step-ok "Your shell is properly configured"
pprint newline
